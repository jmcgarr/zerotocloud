buildscript {
    repositories { jcenter() }
    //dependencies {
    //	classpath 'de.undercouch:gradle-download-task:1.0'
    //}
}

apply plugin: 'war'
//plugins {
//  id 'war'
//  id 'nebula.ospackage' version '3.4.0'
//}

import de.undercouch.gradle.tasks.download.Download
task download(type: Download) {
    src 'http://mirrors.jenkins-ci.org/war-stable/latest/jenkins.war'
    onlyIfNewer true
    dest new File(buildDir, 'jenkins.war')
}

war {
    dependsOn(download)
    from(download)
}

ospackage {
    requires('default-jdk')
    requires('tomcat7')

	from(war) {
        into('/var/lib/tomcat7/webapps/')
        rename(/.*/, 'ROOT.war')
    }

    preInstall('sudo rm -rf /var/lib/tomcat7/webapps/ROOT')
}